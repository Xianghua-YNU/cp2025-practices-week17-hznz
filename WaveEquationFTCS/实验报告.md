# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [胡正一] **学号：** [20231050047] **完成日期：** [6.18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 计算稳定性参数c
c_val = (a * dt / dx)**2

# 初始条件：t=0时刻位移为0
u[:, 0] = 0

# 第一个时间步：使用初始速度
u[1:-1, 1] = u_t(x[1:-1], C, d, sigma, L) * dt

# FTCS主循环
for j in range(1, nt-1):
    # 更新内部点
    u[1:-1, j+1] = c_val * (u[2:, j] + u[:-2, j]) + 2*(1-c_val)*u[1:-1, j] - u[1:-1, j-1]
    
    # 应用边界条件
    u[0, j+1] = 0
    u[-1, j+1] = 0
```

## 3. 实验结果

### 3.1 主要输出

[请在此处插入关键数值结果或生成的动画截图/描述。例如，不同时间点的弦形图，或动画的简要描述。]

### 3.2 结果验证

边界条件验证：

在模拟的每个时间步，弦两端(x=0和x=1)的位移始终为0

满足固定边界条件u(0,t)=0和u(L,t)=0

初始条件验证：

t=0时刻位移为0，符合初始静止条件

t=Δt时刻的位移分布与初始速度剖面ψ(x)的形状一致

波形验证：

波传播速度约为100m/s，与设定波速一致

从x=0.1m传播到x=0.5m约需0.004s，与理论值相符

稳定性验证：

使用参数Δt=5e-5s和Δx=0.01m时，c=0.25<1，解保持稳定

当增大Δt使c≥1时，解迅速发散（见思考题分析）

## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
*   如何确保数值稳定性？
*   动画制作中的挑战？]

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。
*   调整时间步长以满足CFL条件。
*   学习Matplotlib动画模块的使用。]

### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
*   加深了对波动方程和有限差分法的理解。
*   掌握了Python进行科学计算和可视化的技能。
*   认识到数值模拟中稳定性条件的重要性。]

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？
2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
